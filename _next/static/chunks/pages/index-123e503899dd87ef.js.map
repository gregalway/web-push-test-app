{"version":3,"file":"static/chunks/pages/index-123e503899dd87ef.js","mappings":"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","sources":["webpack://_N_E/../../packages/web-push-notifications/esm/bundle-6917a489.js","webpack://_N_E/../../packages/web-push-notifications/esm/index.js","webpack://_N_E/./src/constants.ts","webpack://_N_E/./src/useSetupPushNotifications.ts","webpack://_N_E/./src/NotificationTestScreen.tsx","webpack://_N_E/./pages/index.tsx","webpack://_N_E/"],"sourcesContent":["const _excluded = [\"title\"];\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// Bundled with Packemon: https://packemon.dev\n// Platform: browser, Support: stable, Format: esm\n\nimport { MetricType, logEvent as logEvent$1, logMetric as logMetric$1, init, PlatformName, identify, ActionType, ComponentType } from '@cbhq/client-analytics';\nimport { openDB } from 'idb';\nconst config = {};\nfunction setConfig(newConfig) {\n  Object.assign(config, newConfig);\n}\nfunction logInfo(...args) {\n  if (config.enableConsoleOutput) {\n    // eslint-disable-next-line no-console\n    console.info('[@cbhq/web-push-notifications]: ', ...args);\n  }\n}\nfunction logError(...args) {\n  if (config.enableConsoleOutput) {\n    // eslint-disable-next-line no-console\n    console.error('[@cbhq/web-push-notifications]: ', ...args);\n  }\n}\nconst DB_NAME = 'cb-web-push-db';\n\n// important - when changing the schema, increment this number\nconst DB_VERSION = 1;\nasync function getDb() {\n  return openDB(DB_NAME, DB_VERSION, {\n    upgrade(idbDB) {\n      idbDB.createObjectStore('analytics');\n    }\n  });\n}\nasync function getAnalyticsConfig() {\n  const db = await getDb();\n  return db.get('analytics', 'config');\n}\nasync function setAnalyticsConfig(config) {\n  const db = await getDb();\n  await db.put('analytics', config, 'config');\n}\nlet isInitialized = false;\nconst EVENT_PREFIX = 'notifications.web';\nasync function initAnalytics() {\n  if (isInitialized) {\n    return;\n  }\n  const db = await getAnalyticsConfig();\n  if (db) {\n    const analyticsConfig = db.config,\n      identity = db.identity;\n    if (analyticsConfig) {\n      init(_objectSpread(_objectSpread({}, analyticsConfig), {}, {\n        platform: PlatformName.extension,\n        showDebugLogging: config.enableConsoleOutput,\n        onError: logError\n      }));\n    }\n    if (identity) {\n      identify(identity);\n    }\n  }\n  isInitialized = true;\n}\nasync function logEvent(eventName, eventData) {\n  // in a service worker, we need to initialize analytics SDK before logging events\n  // if from a foreground app, analytics should already be initialized\n  if (config?.isServiceWorker && !isInitialized) {\n    await initAnalytics();\n  }\n  logEvent$1(`${EVENT_PREFIX}.${eventName}`, eventData);\n}\nasync function logMetric(options) {\n  if (config?.isServiceWorker && !isInitialized) {\n    await initAnalytics();\n  }\n  logMetric$1(_objectSpread(_objectSpread({}, options), {}, {\n    metricName: `${EVENT_PREFIX}.${options.metricName}`\n  }));\n}\nfunction getNotificationAnalyticsData(notification) {\n  return {\n    title: notification.title,\n    body: notification.body,\n    icon: notification.icon,\n    template: notification.data?.template,\n    category: notification.data?.message_category\n  };\n}\nasync function logNotificationEvent(notification, event, eventData) {\n  const notificationData = getNotificationAnalyticsData(notification);\n  await Promise.all([logEvent(event, _objectSpread(_objectSpread({}, notificationData), eventData)), logMetric({\n    metricName: event,\n    metricType: MetricType.count,\n    value: 1,\n    tags: {\n      template: notificationData.template?.toString() ?? 'unknown',\n      category: notificationData.category?.toString() ?? 'unknown'\n    }\n  })]);\n}\n\n/* eslint-disable compat/compat */\nasync function showNotification(registration, notification) {\n  // Customize notification here\n  if (!notification) {\n    return;\n  }\n  const title = notification.title,\n    notificationOptions = _objectWithoutProperties(notification, _excluded);\n  await registration.showNotification(title ?? '', notificationOptions);\n}\nfunction handleNotificationEvent(event, notification) {\n  const context = config?.isServiceWorker ? 'background' : 'foreground';\n  logInfo('Notification event:', {\n    event,\n    notification,\n    context\n  });\n  switch (event) {\n    case 'delivered':\n      {\n        void logNotificationEvent(notification, 'delivered', {\n          action: ActionType.measurement,\n          componentType: ComponentType.service_worker,\n          context\n        });\n        break;\n      }\n    case 'clicked':\n      {\n        void logNotificationEvent(notification, 'clicked', {\n          action: ActionType.click,\n          componentType: ComponentType.service_worker,\n          context\n        });\n        break;\n      }\n    default:\n      {\n        logError(`Unhandled notification event: ${event}`);\n      }\n  }\n}\nfunction checkNotificationSupport() {\n  if (!('Notification' in window)) {\n    logError('Notifications not supported in this browser');\n    return false;\n  }\n  return true;\n}\nfunction isPushAuthorized() {\n  if (!checkNotificationSupport()) {\n    return false;\n  }\n  return Notification.permission === 'granted';\n}\nasync function requestPushPermission() {\n  if (!checkNotificationSupport()) {\n    return false;\n  }\n  const result = await Notification.requestPermission();\n  return result === 'granted';\n}\nexport { setAnalyticsConfig as a, logInfo as b, showNotification as c, config as d, handleNotificationEvent as h, isPushAuthorized as i, logError as l, requestPushPermission as r, setConfig as s };\n//# sourceMappingURL=bundle-6917a489.js.map\n","function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// Bundled with Packemon: https://packemon.dev\n// Platform: browser, Support: stable, Format: esm\n\nimport { initializeApp } from 'firebase/app';\nimport { isSupported, getMessaging, getToken, onMessage } from 'firebase/messaging';\nimport { config, identity } from '@cbhq/client-analytics';\nimport { l as logError, i as isPushAuthorized, s as setConfig, a as setAnalyticsConfig, b as logInfo, c as showNotification, h as handleNotificationEvent, d as config$1 } from './bundle-6917a489.js';\nexport { r as requestPushPermission } from './bundle-6917a489.js';\nimport 'idb';\nlet swRegistration = null;\n\n// set up to receive messages while app is foregrounded\nfunction initForegroundHandler(serviceWorkerRegistration) {\n  const messaging = getMessaging();\n  onMessage(messaging, ({\n    notification\n  }) => {\n    if (notification) {\n      void showNotification(serviceWorkerRegistration, notification);\n      handleNotificationEvent('delivered', notification);\n    }\n  });\n}\n\n// ensures service worker is active before we try to use it\nasync function waitForServiceWorker(serviceWorkerRegistration) {\n  return new Promise(resolve => {\n    let sw;\n    if (serviceWorkerRegistration.installing) {\n      sw = serviceWorkerRegistration.installing;\n    } else if (serviceWorkerRegistration.waiting) {\n      sw = serviceWorkerRegistration.waiting;\n    } else if (serviceWorkerRegistration.active) {\n      sw = serviceWorkerRegistration.active;\n    }\n    if (sw) {\n      if (sw.state === 'activated') {\n        resolve();\n      }\n      sw.addEventListener('statechange', e => {\n        logInfo('Waiting for service worker to activate...');\n        if (e.target?.state === 'activated') {\n          logInfo('Service worker ready');\n          resolve();\n        }\n      });\n    }\n  });\n}\n\n/**\n * Register service worker & generate a firebase push token\n */\nasync function initApp(serviceWorkerRegistration, pushConfig) {\n  if (!(await isSupported())) {\n    logError('Failed to initialize, web push is not supported in this browser');\n    return null;\n  }\n  if (!isPushAuthorized()) {\n    logError('Failed to initialize, push permissions are not granted');\n    return null;\n  }\n  setConfig(_objectSpread(_objectSpread({}, pushConfig), {}, {\n    isServiceWorker: false\n  }));\n  const vapidKey = config$1.vapidKey,\n    firebaseConfig = config$1.firebaseConfig;\n\n  // make sure we have the latest service worker versions\n  await serviceWorkerRegistration.update();\n  await waitForServiceWorker(serviceWorkerRegistration);\n  swRegistration = serviceWorkerRegistration;\n\n  // set analytics config in storage\n  if (config) {\n    await setAnalyticsConfig({\n      config: {\n        projectName: config.projectName,\n        isProd: config.isProd,\n        version: config.version,\n        amplitudeApiKey: config.amplitudeApiKey\n      },\n      identity: _objectSpread(_objectSpread({}, identity), {}, {\n        userTypeEnum: identity.userTypeEnum\n      })\n    });\n  }\n  try {\n    const app = initializeApp(firebaseConfig);\n    const messaging = getMessaging(app);\n    const firebaseToken = await getToken(messaging, {\n      vapidKey,\n      serviceWorkerRegistration\n    });\n    initForegroundHandler(serviceWorkerRegistration);\n    logInfo('Firebase token:', firebaseToken);\n    return firebaseToken;\n  } catch {\n    return 'failed to get token';\n  }\n}\nasync function showLocalNotification(notification) {\n  logInfo('Showing local notification:', notification);\n  if (swRegistration) {\n    await showNotification(swRegistration, notification);\n  }\n}\nexport { initApp, isPushAuthorized, showLocalNotification };\n//# sourceMappingURL=index.js.map\n","export const FIREBASE_CONFIG = {\n  apiKey: 'AIzaSyCR6IoCUQ5Em7z695X4YT2rNN5SabIZPYc',\n  authDomain: 'testing-pwa-16aa0.firebaseapp.com',\n  projectId: 'testing-pwa-16aa0',\n  messagingSenderId: '956053544244',\n  appId: '1:956053544244:web:45cb94738abeb014631961',\n};\n\nexport const VAPID_KEY =\n  'BJwXFHi_floI-_83-x2YGl38sLaOnsZhPd_MRKNrhvxGv-NjFPSWb9zHV2oa14LwTl4eWHQHR7rj13c0wU6lneU';\n","import { useCallback, useEffect, useState } from 'react';\nimport { initApp, showLocalNotification } from '@cbhq/web-push-notifications';\n\nimport { FIREBASE_CONFIG, VAPID_KEY } from './constants';\nimport { useRouter } from 'next/router';\n\nexport function useSetupPushNotifications(hasPermission: boolean) {\n  const [token, setToken] = useState<string>('');\n\n  const router = useRouter();\n\n  useEffect(\n    function initNotifications() {\n      if (!hasPermission) {\n        return;\n      }\n      const init = async () => {\n        const serviceWorkerRegistration = await navigator.serviceWorker.register(\n          new URL('./push-notification-sw.ts', import.meta.url),\n        );\n\n        const token = await initApp(serviceWorkerRegistration, {\n          firebaseConfig: FIREBASE_CONFIG,\n          vapidKey: VAPID_KEY,\n          enableConsoleOutput: true,\n        });\n        if (token) {\n          setToken(token);\n        }\n      };\n      init();\n    },\n    [hasPermission, router.push],\n  );\n\n  const sendNotification = useCallback(() => {\n    const notification = {\n      title: 'Local notification!',\n      body: 'testing our notification',\n      data: {\n        url: `${window.origin}/foo`,\n        message_id: 'your_internal_unique_message_id_for_tracking',\n      },\n    };\n    showLocalNotification(notification);\n  }, []);\n\n  return { token, sendNotification };\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport { Button } from '@cbhq/cds-web/buttons';\nimport { TextInput } from '@cbhq/cds-web/controls';\nimport { Box, VStack } from '@cbhq/cds-web/layout';\nimport { isPushAuthorized, requestPushPermission } from '@cbhq/web-push-notifications';\n\nimport { useSetupPushNotifications } from './useSetupPushNotifications';\n\nexport default function NotificationOptInScreen() {\n  const [isPushAuthed, setIsPushAuthed] = useState(false);\n\n  useEffect(() => {\n    setIsPushAuthed(isPushAuthorized());\n  }, []);\n\n  const handleEnablePermissions = useCallback(async () => {\n    if (await requestPushPermission()) {\n      setIsPushAuthed(true);\n    }\n  }, []);\n\n  const { token, sendNotification } = useSetupPushNotifications(isPushAuthed);\n\n  return (\n    <Box alignItems=\"center\" justifyContent=\"center\" spacing={4}>\n      <VStack maxWidth=\"500px\" flexGrow={1} gap={1}>\n        <Button disabled={!!isPushAuthed} onPress={handleEnablePermissions}>\n          Enable Notifications\n        </Button>\n        <Button disabled={!isPushAuthed} onPress={sendNotification}>\n          Send Local Notification\n        </Button>\n        <TextInput disabled label=\"Push Token\" placeholder=\"waiting for push token\" value={token} />\n      </VStack>\n    </Box>\n  );\n}\n","import Head from 'next/head';\n\nimport NotificationTestScreen from '../src/NotificationTestScreen';\n\nexport default function Home() {\n  return (\n    <div className=\"container\">\n      <Head>\n        <title>Web Notification Test App</title>\n        <link rel=\"icon\" href=\"/favicon.ico\" />\n        <link rel=\"manifest\" href=\"/manifest.json\" />\n      </Head>\n      <NotificationTestScreen />\n    </div>\n  );\n}\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/\",\n      function () {\n        return require(\"private-next-pages/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/\"])\n      });\n    }\n  "],"names":["_excluded","_objectWithoutProperties","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","ownKeys","e","r","t","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","Symbol","toPrimitive","TypeError","String","Number","_toPrimitive","_toPropertyKey","configurable","writable","config","logInfo","enableConsoleOutput","_len","args","Array","_key","console","info","logError","_len2","_key2","error","DB_NAME","DB_VERSION","async","getDb","openDB","upgrade","idbDB","createObjectStore","isInitialized","EVENT_PREFIX","initAnalytics","db","get","getAnalyticsConfig","analyticsConfig","identity","init","platform","PlatformName","extension","showDebugLogging","onError","identify","logEvent","eventName","eventData","isServiceWorker","logEvent$1","concat","logMetric","options","logMetric$1","metricName","logNotificationEvent","notification","event","_notificationData$tem","_notificationData$tem2","_notificationData$cat","_notificationData$cat2","notificationData","_notification$data","_notification$data2","title","body","icon","template","data","category","message_category","getNotificationAnalyticsData","Promise","all","metricType","MetricType","count","tags","toString","showNotification","registration","notificationOptions","checkNotificationSupport","window","isPushAuthorized","Notification","permission","swRegistration","initForegroundHandler","serviceWorkerRegistration","messaging","getMessaging","onMessage","_ref","context","action","ActionType","measurement","componentType","ComponentType","service_worker","click","handleNotificationEvent","initApp","pushConfig","isSupported","newConfig","assign","vapidKey","config$1","firebaseConfig","update","resolve","sw","installing","waiting","active","state","addEventListener","_e$target","waitForServiceWorker","put","setAnalyticsConfig","projectName","isProd","version","amplitudeApiKey","userTypeEnum","app","initializeApp","firebaseToken","getToken","_unused","FIREBASE_CONFIG","apiKey","authDomain","projectId","messagingSenderId","appId","VAPID_KEY","useSetupPushNotifications","hasPermission","token","setToken","useState","router","useRouter","useEffect","navigator","serviceWorker","register","URL","sendNotification","useCallback","showLocalNotification","url","origin","message_id","NotificationOptInScreen","isPushAuthed","setIsPushAuthed","handleEnablePermissions","requestPermission","requestPushPermission","_jsx","Box","alignItems","justifyContent","spacing","children","_jsxs","VStack","maxWidth","flexGrow","gap","Button","disabled","onPress","TextInput","label","placeholder","Home","className","Head","rel","href","NotificationTestScreen","__NEXT_P"],"sourceRoot":""}